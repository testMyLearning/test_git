<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á</title>
    <style>
        .badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: white;
        }
        .badge-success { background-color: #28a745; }
        .badge-warning { background-color: #ffc107; }
        .badge-secondary { background-color: #6c757d; }
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button {
            padding: 5px 10px;
            margin: 2px;
        }
        .task-id {
            width: 50px;
        }
        .task-status {
            width: 100px;
        }
        .actions {
            width: 150px;
        }
        .description {
            width: 150px;
        }
        .date {
            width: 150px;
        }
        .auth-buttons {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .btn-logout {
            background-color: #f44336;
            color: white;
        }
        .btn {
            padding: 10px 20px;
            margin-left: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }
        .btn-login {
            background-color: #4CAF50;
            color: white;
        }
        .btn-register {
            background-color: #008CBA;
            color: white;
        }
    </style>
</head>
<body>
<!-- –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫ –∫—É–¥–∞ —Ö–æ—Ç–∏—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ <h1> -->
<div style="
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
">
    <h3 style="margin-top: 0;">
        üìä –í—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –∑–∞–¥–∞—á –∑–∞ 24 —á–∞—Å–∞:
    </h3>
    <div style="font-size: 48px; font-weight: bold; margin: 10px 0;">
        <span th:text="${completedCount}">0</span>
    </div>
    <p style="margin-bottom: 0; opacity: 0.9;">
        –°—á–µ—Ç—á–∏–∫ —Å–±—Ä–æ—Å–∏—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏
    </p>
</div>
<div class ="auth-buttons">
    <!-- –¢–µ–∫—É—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ user –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è -->
    <div th:if="${user != null}">
        <span>
            –ü—Ä–∏–≤–µ—Ç, <strong th:text="${user.name}"></strong>!
            <form th:action="@{/logout}" method="post" style="display: inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn btn-logout">[–í—ã–π—Ç–∏]</button>
            </form>
        </span>
    </div>
    <div th:unless="${user != null}">
        <a th:href="@{/login}" class="btn btn-login">–í–æ–π—Ç–∏</a>
        <a th:href="@{/registration}" class="btn btn-register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
    </div>
</div>
<h1>–ú–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á</h1>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ -->
<div>
    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h3>
    <form method="post" th:action="@{/v1/task}" th:object="${task}">
        <input type="hidden" name="userId" th:value="${user.id}" />
        <input type="text" th:field="*{name}" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
        <input type="text" th:field="*{description}" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
        <input type="date" th:field="*{deadline}">
        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
    </form>
</div>
<!-- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É -->
<div style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-radius: 5px;">
    <h4 style="margin-top: 0;">–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É</h4>

    <form method="get" th:action="@{/v1/task/main}">
        <select name="status" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">–í—Å–µ –∑–∞–¥–∞—á–∏</option>
            <option value="ACTIVE"
                    th:selected="${param.status == 'ACTIVE'}">
                –ê–∫—Ç–∏–≤–Ω—ã–µ
            </option>
            <option value="INACTIVE"
                    th:selected="${param.status == 'INACTIVE'}">
                –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ
            </option>
        </select>

        <button type="submit"
                style="margin-left: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
            –ü—Ä–∏–º–µ–Ω–∏—Ç—å
        </button>

        <a th:href="@{/v1/task/main}"
           style="margin-left: 10px; padding: 8px 15px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 4px;">
            –°–±—Ä–æ—Å–∏—Ç—å
        </a>
    </form>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞—á -->
<h3>–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h3>
<table>
    <thead>
    <tr>
        <th class="task-id">ID</th>
        <th class="name">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
        <th class="description">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
        <th class="date">–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</th>
        <th class="task-status">–°—Ç–∞—Ç—É—Å</th>
        <th class="actions">–î–µ–π—Å—Ç–≤–∏—è</th>

    </tr>
    </thead>
    <tbody>
    <!-- –¶–∏–∫–ª –ø–æ –∑–∞–¥–∞—á–∞–º -->
    <tr th:each="task : ${tasks}">
        <!-- ID (UUID) -->
        <td th:text="${task.id}">550e8400-e29b-41d4-a716-446655440000</td>

        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ -->
        <td th:text="${task.name}">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</td>

        <!-- –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ -->
        <td th:text="${task.description}">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏...</td>

        <!-- –°—Ç–∞—Ç—É—Å -->

        
        <!-- –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
        <td th:text="${#temporals.format(task.deadline, 'dd.MM.yyyy')}">15.01.2024</td>
        <td>
    <span th:switch="${task.status}">
        <span th:case="${T(com.example.todo.model.enums.StatusTask).ACTIVE}"
              th:text="${task.status.displayName}">–ê–∫—Ç–∏–≤–Ω–∞</span>
        <span th:case="${T(com.example.todo.model.enums.StatusTask).INACTIVE}"
              th:text="${task.status.displayName}">–ù–µ–∞–∫—Ç–∏–≤–Ω–∞</span>
        <span th:case="${T(com.example.todo.model.enums.StatusTask).COMPLETED}"
              th:text="${task.status.displayName}">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</span>
    </span>
        </td>

        <!-- –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª–µ dueDate, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Å–µ) -->
        <!-- <td th:text="${task.dueDate != null} ? ${#temporals.format(task.dueDate, 'dd.MM.yyyy')} : '–ù–µ—Ç'">
            20.01.2024
        </td> -->

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <td class="actions">

            <form th:action="@{/v1/task/delete/{id}(id=${task.id})}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-sm btn-danger"
                        onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?')">
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </form>
            <form th:action="@{/v1/task/changeStatus/{id}/{status}(id=${task.id},status='INACTIVE')}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-sm btn-danger"
                        onclick="return confirm('–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å?')">
                    –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                </button>
            </form>
            <form th:action="@{/v1/task/changeStatus/{id}/{status}(id=${task.id},status='COMPLETED')}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-sm btn-danger">
                    –ó–∞–≤–µ—Ä—à–∏—Ç—å
                </button>
            </form>
        </td>
    </tr>

    <!-- –ï—Å–ª–∏ –∑–∞–¥–∞—á –Ω–µ—Ç -->
    <tr th:if="${tasks.size()==0}">
        <td colspan="6" style="text-align: center; color: #666;">
            –ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!
        </td>
    </tr>
    </tbody>
</table>

<div>
    <p>–í—Å–µ–≥–æ –∑–∞–¥–∞—á: <span th:text="${tasks.size()}">0</span></p>
</div>
</body>
</html>